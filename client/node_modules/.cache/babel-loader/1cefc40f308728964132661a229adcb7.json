{"ast":null,"code":"import n, { useRef as e, useEffect as t, cloneElement as o } from \"react\";\n\nfunction r(n, e, t) {\n  return e in n ? Object.defineProperty(n, e, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : n[e] = t, n;\n}\n\nvar u = {\n  click: \"onClick\",\n  focusin: \"onFocus\",\n  focusout: \"onFocus\",\n  mousedown: \"onMouseDown\",\n  mouseup: \"onMouseUp\",\n  touchstart: \"onTouchStart\",\n  touchend: \"onTouchEnd\"\n},\n    c = function (c) {\n  var i,\n      a = c.children,\n      d = c.onClickAway,\n      s = c.focusEvent,\n      v = void 0 === s ? \"focusin\" : s,\n      f = c.mouseEvent,\n      l = void 0 === f ? \"click\" : f,\n      m = c.touchEvent,\n      E = void 0 === m ? \"touchend\" : m,\n      p = e(null),\n      h = e(null),\n      L = e(!1);\n  t(function () {\n    return setTimeout(function () {\n      L.current = !0;\n    }, 0), function () {\n      L.current = !1;\n    };\n  }, []);\n\n  var y = function (n) {\n    return function (e) {\n      h.current = e.target;\n      var t = null == a ? void 0 : a.props[n];\n      t && t(e);\n    };\n  };\n\n  t(function () {\n    var n = function (n) {\n      L.current && (p.current && p.current.contains(n.target) || h.current === n.target || !document.contains(n.target) || d(n));\n    };\n\n    return document.addEventListener(l, n), document.addEventListener(E, n), document.addEventListener(v, n), function () {\n      document.removeEventListener(l, n), document.removeEventListener(E, n), document.removeEventListener(v, n);\n    };\n  }, [v, l, d, E]);\n  var g = u[l],\n      k = u[E],\n      w = u[v];\n  return n.Children.only(o(a, (r(i = {\n    ref: function (n) {\n      p.current = n;\n      var e = a.ref;\n      \"function\" == typeof e ? e(n) : e && (e.current = n);\n    }\n  }, w, y(w)), r(i, g, y(g)), r(i, k, y(k)), i)));\n};\n\nc.displayName = \"ClickAwayListener\";\nexport default c;","map":{"version":3,"sources":["../src/index.tsx"],"names":["eventTypeMapping","click","focusin","focusout","mousedown","mouseup","touchstart","touchend","ClickAwayListener","children","onClickAway","focusEvent","mouseEvent","touchEvent","node","useRef","bubbledEventTarget","mountedRef","useEffect","setTimeout","current","handleBubbledEvents","type","event","target","handler","props","childRef","ref","handleEvents","contains","document","addEventListener","removeEventListener","mappedMouseEvent","mappedTouchEvent","mappedFocusEvent","React","Children","only","cloneElement","displayName"],"mappings":"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","sourcesContent":["import React, {\n\tuseRef,\n\tuseEffect,\n\tRefCallback,\n\tcloneElement,\n\tReactElement,\n\tHTMLAttributes,\n\tMutableRefObject,\n\tFunctionComponent\n} from 'react';\n\ntype FocusEvents = 'focusin' | 'focusout';\ntype MouseEvents = 'click' | 'mousedown' | 'mouseup';\ntype TouchEvents = 'touchstart' | 'touchend';\ntype Events = FocusEvent | MouseEvent | TouchEvent;\n\ninterface Props extends HTMLAttributes<HTMLElement> {\n\tonClickAway: (event: Events) => void;\n\tfocusEvent?: FocusEvents;\n\tmouseEvent?: MouseEvents;\n\ttouchEvent?: TouchEvents;\n\tchildren: ReactElement<any>;\n}\n\nconst eventTypeMapping = {\n\tclick: 'onClick',\n\tfocusin: 'onFocus',\n\tfocusout: 'onFocus',\n\tmousedown: 'onMouseDown',\n\tmouseup: 'onMouseUp',\n\ttouchstart: 'onTouchStart',\n\ttouchend: 'onTouchEnd'\n};\n\nconst ClickAwayListener: FunctionComponent<Props> = ({\n\tchildren,\n\tonClickAway,\n\tfocusEvent = 'focusin',\n\tmouseEvent = 'click',\n\ttouchEvent = 'touchend'\n}) => {\n\tconst node = useRef<HTMLElement | null>(null);\n\tconst bubbledEventTarget = useRef<EventTarget | null>(null);\n\tconst mountedRef = useRef(false);\n\n\t/**\n\t * Prevents the bubbled event from getting triggered immediately\n\t * https://github.com/facebook/react/issues/20074\n\t */\n\tuseEffect(() => {\n\t\tsetTimeout(() => {\n\t\t\tmountedRef.current = true;\n\t\t}, 0);\n\n\t\treturn () => {\n\t\t\tmountedRef.current = false;\n\t\t};\n\t}, []);\n\n\tconst handleBubbledEvents =\n\t\t(type: string) =>\n\t\t(event: Events): void => {\n\t\t\tbubbledEventTarget.current = event.target;\n\n\t\t\tconst handler = children?.props[type];\n\n\t\t\tif (handler) {\n\t\t\t\thandler(event);\n\t\t\t}\n\t\t};\n\n\tconst handleChildRef = (childRef: HTMLElement) => {\n\t\tnode.current = childRef;\n\n\t\tlet { ref } = children as typeof children & {\n\t\t\tref: RefCallback<HTMLElement> | MutableRefObject<HTMLElement>;\n\t\t};\n\n\t\tif (typeof ref === 'function') {\n\t\t\tref(childRef);\n\t\t} else if (ref) {\n\t\t\tref.current = childRef;\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tconst handleEvents = (event: Events): void => {\n\t\t\tif (!mountedRef.current) return;\n\n\t\t\tif (\n\t\t\t\t(node.current && node.current.contains(event.target as Node)) ||\n\t\t\t\tbubbledEventTarget.current === event.target ||\n\t\t\t\t!document.contains(event.target as Node)\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tonClickAway(event);\n\t\t};\n\n\t\tdocument.addEventListener(mouseEvent, handleEvents);\n\t\tdocument.addEventListener(touchEvent, handleEvents);\n\t\tdocument.addEventListener(focusEvent, handleEvents);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(mouseEvent, handleEvents);\n\t\t\tdocument.removeEventListener(touchEvent, handleEvents);\n\t\t\tdocument.removeEventListener(focusEvent, handleEvents);\n\t\t};\n\t}, [focusEvent, mouseEvent, onClickAway, touchEvent]);\n\n\tconst mappedMouseEvent = eventTypeMapping[mouseEvent];\n\tconst mappedTouchEvent = eventTypeMapping[touchEvent];\n\tconst mappedFocusEvent = eventTypeMapping[focusEvent];\n\n\treturn React.Children.only(\n\t\tcloneElement(children as ReactElement<any>, {\n\t\t\tref: handleChildRef,\n\t\t\t[mappedFocusEvent]: handleBubbledEvents(mappedFocusEvent),\n\t\t\t[mappedMouseEvent]: handleBubbledEvents(mappedMouseEvent),\n\t\t\t[mappedTouchEvent]: handleBubbledEvents(mappedTouchEvent)\n\t\t})\n\t);\n};\n\nClickAwayListener.displayName = 'ClickAwayListener';\n\nexport default ClickAwayListener;\n"]},"metadata":{},"sourceType":"module"}